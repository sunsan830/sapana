<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For Sapana ‚ù§Ô∏è</title>
    <style>
        :root {
            --valentine-red: #d00000;
            --white: #ffffff;
            --glow-color: rgba(208, 0, 0, 0.6);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; padding: 0; display: flex; flex-direction: column; justify-content: center; align-items: center;
            min-height: 100vh; background-color: var(--valentine-red);
            font-family: 'Arial', sans-serif; overflow: hidden; touch-action: none;
            position: relative;
        }

        .container {
            text-align: center; background: var(--white); padding: 3rem 2rem; border-radius: 40px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.6); width: 95%; max-width: 420px; 
            position: relative; z-index: 10;
        }

        .gif-container img { width: 160px; margin-bottom: 25px; border-radius: 15px; }
        h1 { color: var(--valentine-red); font-size: 1.8rem; margin-bottom: 2.5rem; }

        .buttons { display: flex; flex-direction: column; gap: 20px; align-items: center; }

        button.main-btn {
            width: 100%; max-width: 260px; padding: 18px; font-size: 1.4rem;
            font-weight: bold; border: none; border-radius: 25px; cursor: pointer;
            transition: all 0.3s ease;
        }

        #yesBtn { background-color: #28a745; color: white; }
        #noBtn { background-color: #f0f0f0; color: #555; }

        /* THE HEART FRAME & NAV BUTTONS */
        .slideshow-wrapper {
            position: relative; width: 320px; height: 320px; margin: 0 auto 25px;
            display: flex; align-items: center; justify-content: center;
            filter: drop-shadow(0 0 15px var(--glow-color));
        }

        .slideshow-container {
            width: 100%; height: 100%; position: relative;
            clip-path: url(#heart-shape); background: #fff;
            overflow: hidden;
        }

        .slideshow-container img {
            width: 100%; height: 100%; object-fit: cover; object-position: center;
            position: absolute; top: 0; left: 0; opacity: 0; 
            transition: opacity 1s ease-in-out;
        }

        .slideshow-container img.active { 
            opacity: 1; 
            animation: kenBurns 6s ease-in-out infinite; 
        }

        @keyframes kenBurns {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
        }

        /* NAVIGATION BUTTONS RESTORED */
        .nav-btn {
            position: absolute; top: 50%; transform: translateY(-50%);
            background: rgba(208, 0, 0, 0.4); border: none; border-radius: 50%;
            width: 40px; height: 40px; cursor: pointer; color: white;
            font-weight: bold; font-size: 1.2rem; z-index: 30;
            display: flex; align-items: center; justify-content: center;
        }
        .prev { left: -10px; }
        .next { right: -10px; }

        /* HEART BURST EFFECT */
        .celebration-heart {
            position: fixed; bottom: -10vh; font-size: 2rem;
            pointer-events: none; z-index: 999;
            animation: rise 3s ease-out forwards;
        }

        @keyframes rise {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-120vh) rotate(360deg); opacity: 0; }
        }

        footer {
            position: absolute; bottom: 20px; left: 0; right: 0; text-align: center;
            color: #ffffff; font-size: 0.85rem; font-weight: bold;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.4); z-index: 100;
        }

        .hidden { display: none !important; }

        .heart-particle {
            position: fixed; pointer-events: none; font-size: 32px; z-index: 5;
            animation: floatUp 1s ease-out forwards;
        }
        @keyframes floatUp {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 1; }
            100% { transform: translate(-50%, -200%) scale(1.5); opacity: 0; }
        }
    </style>
</head>
<body>

    <svg width="0" height="0" style="position: absolute;">
        <defs>
            <clipPath id="heart-shape" clipPathUnits="objectBoundingBox">
                <path d="M0.5,0.95 L0.441,0.895 C0.176,0.641,0,0.485,0,0.297 C0,0.133,0.133,0,0.297,0 C0.39,0,0.479,0.043,0.5,0.11 C0.521,0.043,0.61,0,0.703,0 C0.867,0,1,0.133,1,0.297 C1,0.485,0.824,0.641,0.559,0.895 L0.5,0.95"></path>
            </clipPath>
        </defs>
    </svg>

    <div class="container">
        <div id="askSection">
            <div class="gif-container">
                <img src="puppy.gif" alt="Puppy">
            </div>
            <h1 id="mainHeading">Will you disappear with Me, Sapana?</h1>
            <div class="buttons">
                <button id="yesBtn" class="main-btn">Yes</button>
                <button id="noBtn" class="main-btn">No</button>
            </div>
        </div>

        <div id="successSection" class="hidden">
            <div class="slideshow-wrapper">
                <button class="nav-btn prev" onclick="moveSlide(-1)">&#10094;</button>
                <div class="slideshow-container" id="slideshow"></div>
                <button class="nav-btn next" onclick="moveSlide(1)">&#10095;</button>
            </div>
            <h2 style="color: var(--valentine-red); margin: 0; font-size: 1.8rem;">Thank You! ‚ù§Ô∏è</h2>
            <p style="font-size: 1.3rem; color: #333; margin-top: 15px; font-weight: bold;">"You are my paradise"</p>
        </div>
    </div>

    <footer>&copy; Sandeep Sapkota</footer>

    <form id="clickTracker" action="https://formspree.io/f/mreapowz" method="POST" style="display:none;">
        <input type="hidden" name="Message" value="Sapana said YES!">
        <input type="hidden" name="NoClicks" id="noClickCountInput" value="0">
    </form>

    <script>
        const images = ['img1.png', 'img2.png', 'img3.png', 'img4.png', 'img5.png', 'img6.png', 'img7.png'];
        let currentIdx = 0;
        
        const slideshow = document.getElementById('slideshow');
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');
        const askSection = document.getElementById('askSection');
        const successSection = document.getElementById('successSection');

        images.forEach((src, i) => {
            const img = document.createElement('img');
            img.src = src;
            img.onerror = function() { this.src = 'https://via.placeholder.com/320x320?text=‚ù§Ô∏è'; };
            if (i === 0) img.classList.add('active');
            slideshow.appendChild(img);
        });

        // Fixed navigation logic
        function moveSlide(step) {
            const imgs = slideshow.querySelectorAll('img');
            if (imgs.length === 0) return;
            imgs[currentIdx].classList.remove('active');
            currentIdx = (currentIdx + step + imgs.length) % imgs.length;
            imgs[currentIdx].classList.add('active');
        }

        function burstHearts() {
            const heartIcons = ['‚ù§Ô∏è', 'üíñ', 'üíù', 'üíï', 'üíò'];
            for (let i = 0; i < 40; i++) {
                setTimeout(() => {
                    const heart = document.createElement('div');
                    heart.className = 'celebration-heart';
                    heart.innerHTML = heartIcons[Math.floor(Math.random() * heartIcons.length)];
                    heart.style.left = Math.random() * 100 + 'vw';
                    heart.style.fontSize = (Math.random() * 20 + 20) + 'px';
                    heart.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    document.body.appendChild(heart);
                    setTimeout(() => heart.remove(), 4000);
                }, i * 50);
            }
        }

        let clickCount = 0;
        noBtn.addEventListener('click', () => {
            clickCount++;
            document.getElementById('noClickCountInput').value = clickCount;
            if (clickCount === 1) noBtn.innerText = "Are you sure?";
            else if (clickCount === 2) noBtn.innerText = "Really sure??";
            else {
                document.getElementById('mainHeading').innerText = "I am Crying Now...Please say Yes! ü•∫";
                noBtn.style.display = 'none';
                yesBtn.style.transform = "scale(1.4)";
            }
        });

        yesBtn.addEventListener('click', () => {
            askSection.classList.add('hidden');
            successSection.classList.remove('hidden');
            burstHearts();
            setInterval(() => moveSlide(1), 5000);

            fetch(document.getElementById('clickTracker').action, {
                method: 'POST',
                body: new FormData(document.getElementById('clickTracker')),
                headers: { 'Accept': 'application/json' }
            });
        });

        window.addEventListener('mousemove', (e) => {
            const heart = document.createElement('div');
            heart.className = 'heart-particle';
            heart.innerHTML = '‚ù§Ô∏è';
            heart.style.left = e.clientX + 'px';
            heart.style.top = e.clientY + 'px';
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 1000);
        });
    </script>
</body>
</html>
